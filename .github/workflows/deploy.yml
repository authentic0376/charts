# .github/workflows/deploy.yml
name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main # main 브랜치에 푸시될 때 실행 (master 브랜치 사용 시 master로 변경)
  workflow_dispatch: # 수동 실행 버튼 추가

# 작업(Job) 설정
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # 실행 환경
    permissions:
      contents: write # gh-pages 브랜치에 쓰기 권한 필요

    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v4 # 코드 체크아웃

      - name: Set up Node.js ⚙️
        uses: actions/setup-node@v4 # Node.js 환경 설정
        with:
          node-version: '18' # 사용하는 Node.js 버전 명시 (프로젝트에 맞게)
          cache: 'npm' # npm 캐시 사용 (yarn 사용 시 'yarn')

      - name: Install dependencies 📦
        run: npm ci # npm ci 사용 (npm install보다 빠르고 안정적), yarn 사용 시 yarn install --frozen-lockfile

      - name: Build 🔨
        run: npm run build # 빌드 스크립트 실행 (package.json에 정의된 대로)

      - name: Deploy to GitHub Pages 🚀
        uses: peaceiris/actions-gh-pages@v3 # 배포 액션 사용
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }} # GitHub 토큰 (자동 제공됨)
          publish_dir: ./dist # 배포할 폴더 지정 (Vite 빌드 결과 폴더)
          # publish_branch: gh-pages # 배포될 브랜치 이름 (기본값 gh-pages)
          # user_name: 'github-actions[bot]' # 커밋 유저 이름 (선택 사항)
          # user_email: 'github-actions[bot]@users.noreply.github.com' # 커밋 유저 이메일 (선택 사항)
          # cname: your-custom-domain.com # 커스텀 도메인 사용 시 (선택 사항)